<% content_for :page_actions do %>
  <div class="flex space-x-2">
    <%= link_to new_admin_event_path, class: "btn btn-primary btn-sm" do %>
      <i class="fas fa-plus mr-2"></i>
      New Event
    <% end %>
    <%= link_to new_admin_user_path, class: "btn btn-secondary btn-sm" do %>
      <i class="fas fa-user-plus mr-2"></i>
      New User
    <% end %>
  </div>
<% end %>

<!-- Statistics Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
  <!-- Total Events -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="card-title text-2xl font-bold text-primary"><%= @stats[:total_events] %></h2>
          <p class="text-base-content/70">Total Events</p>
        </div>
        <div class="w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center">
          <i class="fas fa-calendar-alt text-primary text-xl"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Total Users -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="card-title text-2xl font-bold text-secondary"><%= @stats[:total_users] %></h2>
          <p class="text-base-content/70">Total Users</p>
        </div>
        <div class="w-12 h-12 bg-secondary/10 rounded-lg flex items-center justify-center">
          <i class="fas fa-users text-secondary text-xl"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Total Performers -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="card-title text-2xl font-bold text-accent"><%= @stats[:total_performers] %></h2>
          <p class="text-base-content/70">Total Performers</p>
        </div>
        <div class="w-12 h-12 bg-accent/10 rounded-lg flex items-center justify-center">
          <i class="fas fa-microphone text-accent text-xl"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Total Tips Amount -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="card-title text-2xl font-bold text-success">$<%= number_with_delimiter(@stats[:total_tip_amount].to_i) %></h2>
          <p class="text-base-content/70">Total Tips (<%= @stats[:total_tips] %>)</p>
        </div>
        <div class="w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center">
          <i class="fas fa-dollar-sign text-success text-xl"></i>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Main Content Grid -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
  <!-- Recent Events -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <div class="flex items-center justify-between mb-4">
        <h2 class="card-title">
          <i class="fas fa-calendar-alt mr-2"></i>
          Recent Events
        </h2>
        <%= link_to "View All", admin_events_path, class: "btn btn-sm btn-outline" %>
      </div>
      
      <% if @stats[:recent_events].any? %>
        <div class="space-y-3">
          <% @stats[:recent_events].each do |event| %>
            <div class="flex items-center justify-between p-3 bg-base-200 rounded-lg">
              <div class="flex-1">
                <h3 class="font-semibold text-base-content">
                  <%= link_to event.title, admin_event_path(event), class: "hover:text-primary" %>
                </h3>
                <p class="text-sm text-base-content/70">
                  <i class="fas fa-map-marker-alt mr-1"></i>
                  <%= event.location %>
                </p>
                <p class="text-sm text-base-content/70">
                  <i class="fas fa-clock mr-1"></i>
                  <%= event.date.strftime("%B %d, %Y at %I:%M %p") %>
                </p>
              </div>
              <div class="text-right">
                <div class="badge badge-primary badge-sm">
                  <%= pluralize(event.tips.count, 'tip') %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8">
          <i class="fas fa-calendar-plus text-4xl text-base-content/30 mb-4"></i>
          <p class="text-base-content/70">No events yet</p>
          <%= link_to "Create your first event", new_admin_event_path, class: "btn btn-primary btn-sm mt-2" %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Recent Tips -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <div class="flex items-center justify-between mb-4">
        <h2 class="card-title">
          <i class="fas fa-dollar-sign mr-2"></i>
          Recent Tips
        </h2>
        <%= link_to "View All", admin_tips_path, class: "btn btn-sm btn-outline" %>
      </div>
      
      <% if @stats[:recent_tips].any? %>
        <div class="space-y-3">
          <% @stats[:recent_tips].each do |tip| %>
            <div class="flex items-center justify-between p-3 bg-base-200 rounded-lg">
              <div class="flex-1">
                <div class="flex items-center space-x-3">
                  <div class="avatar">
                    <div class="w-8 rounded-full ring ring-primary ring-offset-base-100 ring-offset-1">
                      <%= user_avatar_image(tip.user, size: :thumb) %>
                    </div>
                  </div>
                  <div>
                    <h3 class="font-semibold text-base-content"><%= tip.user.name %></h3>
                    <p class="text-sm text-base-content/70">
                      <%= link_to tip.event.title, admin_event_path(tip.event), class: "hover:text-primary" %>
                    </p>
                  </div>
                </div>
              </div>
              <div class="text-right">
                <div class="badge badge-success font-bold">
                  $<%= tip.amount.to_f %>
                </div>
                <p class="text-xs text-base-content/50 mt-1">
                  <%= time_ago_in_words(tip.created_at) %> ago
                </p>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8">
          <i class="fas fa-hand-holding-usd text-4xl text-base-content/30 mb-4"></i>
          <p class="text-base-content/70">No tips yet</p>
        </div>
      <% end %>
    </div>
  </div>
</div>

<!-- Additional Stats Row -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
  <!-- Admin Users -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body text-center">
      <div class="w-16 h-16 bg-warning/10 rounded-full flex items-center justify-center mx-auto mb-4">
        <i class="fas fa-user-shield text-warning text-2xl"></i>
      </div>
      <h2 class="card-title text-2xl font-bold text-warning justify-center"><%= @stats[:admin_users] %></h2>
      <p class="text-base-content/70">Admin Users</p>
      <%= link_to "Manage Users", admin_users_path, class: "btn btn-warning btn-sm mt-2" %>
    </div>
  </div>

  <!-- System Status -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body text-center">
      <div class="w-16 h-16 bg-info/10 rounded-full flex items-center justify-center mx-auto mb-4">
        <i class="fas fa-server text-info text-2xl"></i>
      </div>
      <h2 class="card-title text-lg font-bold text-info justify-center">System Online</h2>
      <p class="text-base-content/70">All services running</p>
      <%= link_to "Legacy Admin", '/admin', class: "btn btn-info btn-sm mt-2" %>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="card bg-base-100 shadow-xl">
    <div class="card-body text-center">
      <div class="w-16 h-16 bg-neutral/10 rounded-full flex items-center justify-center mx-auto mb-4">
        <i class="fas fa-bolt text-neutral text-2xl"></i>
      </div>
      <h2 class="card-title text-lg font-bold text-neutral justify-center">Quick Actions</h2>
      <p class="text-base-content/70">Common tasks</p>
      <div class="flex justify-center space-x-2 mt-2">
        <%= link_to new_admin_performer_path, class: "btn btn-neutral btn-xs" do %>
          <i class="fas fa-microphone mr-1"></i>
          Add Performer
        <% end %>
      </div>
    </div>
  </div>
</div>
