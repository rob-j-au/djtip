<div class="container mx-auto p-4 md:p-8">
  <div class="card bg-base-100 shadow-xl mb-8">
    <div class="card-body">
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
        <div>
          <h1 class="card-title text-4xl">Tips for <%= @event.title %></h1>
          <p class="text-base-content/70 mt-1">Track and manage all tip contributions for <%= @event.title %></p>
        </div>
        <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto">
          <%= link_to 'Back to Event', @event, class: 'btn btn-outline' %>
          <%= link_to "New Tip", new_event_tip_path(@event), class: 'btn btn-primary' %>
        </div>
      </div>
    </div>
  </div>

  <% if @tips.any? %>
    <div class="card bg-base-100 shadow-xl">
      <div class="overflow-x-auto">
        <table class="table">
          <thead>
            <tr>
              <th>Amount</th>
              <th>User</th>
              <th>Message</th>
              <th>Date</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @tips.each do |tip| %>
              <tr class="hover">
                <td>
                  <div class="badge badge-success gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    <%= tip.formatted_amount %>
                  </div>
                </td>
                <td>
                  <% if tip.user %>
                    <div class="flex items-center gap-3">
                      <% if tip.user.image_data? && tip.user.image_url(:thumb) %>
                        <div class="avatar">
                          <div class="w-8 rounded-full ring ring-primary ring-offset-base-100 ring-offset-1">
                            <%= image_tag tip.user.image_url(:thumb), alt: tip.user.name, class: "rounded-full object-cover" %>
                          </div>
                        </div>
                      <% else %>
                        <div class="avatar placeholder">
                          <div class="bg-gradient-to-br from-primary to-secondary text-primary-content rounded-full w-8">
                            <span class="text-xs font-bold"><%= tip.user.name&.first&.upcase || 'U' %></span>
                          </div>
                        </div>
                      <% end %>
                      <div>
                        <div class="font-bold"><%= tip.user.name %></div>
                        <div class="text-sm opacity-50"><%= tip.user.email %></div>
                      </div>
                    </div>
                  <% else %>
                    <span class="opacity-70">Anonymous</span>
                  <% end %>
                </td>
                <td>
                  <div class="text-sm"><%= tip.message.presence || 'â€”' %></div>
                </td>
                <td>
                  <div class="text-sm opacity-70"><%= tip.created_at.strftime('%b %d, %Y %l:%M %p') %></div>
                </td>
                <th>
                  <div class="flex gap-2">
                    <%= link_to 'View', [@event, tip], class: 'btn btn-ghost btn-xs' %>
                    <%= link_to 'Edit', edit_event_tip_path(@event, tip), class: 'btn btn-ghost btn-xs' %>
                    <%= button_to 'Delete', [@event, tip], method: :delete, 
                                  class: 'btn btn-ghost btn-xs text-error',
                                  data: { 
                                    confirm: 'Are you sure?',
                                    turbo_method: :delete 
                                  } %>
                  </div>
                </th>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  <% else %>
    <div class="card bg-base-100 shadow-xl">
      <div class="card-body items-center text-center py-16">
        <svg class="w-16 h-16 text-base-content/20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
        </svg>
        <h3 class="card-title mt-4">No tips yet</h3>
        <p class="text-base-content/70 mb-6">Start tracking tips for this event by adding the first tip.</p>
        <div class="flex gap-2">
          <%= link_to 'Back to Event', @event, class: 'btn btn-outline' %>
          <%= link_to 'Add First Tip', new_event_tip_path(@event), class: 'btn btn-primary' %>
        </div>
      </div>
    </div>
  <% end %>
</div>
