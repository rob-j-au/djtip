<!DOCTYPE html>
<html lang="en" data-theme="cupcake">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title><%= [content_for(:page_title), @page_title, @model_config&.label, @abstract_model&.pretty_name, "Admin"].compact.join(" | ") %></title>
  
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  
  <!-- Main application CSS (includes Tailwind and daisyUI) -->
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  
  <!-- RailsAdmin daisyUI theme integration -->
  <%= stylesheet_link_tag "rails_admin_daisyui", "data-turbo-track": "reload" %>
  
  <!-- Bootstrap CSS (without integrity) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Font Awesome (without integrity) -->
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" rel="stylesheet">
  
  <!-- jQuery UI CSS -->
  <link href="https://code.jquery.com/ui/1.13.3/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
  
  <!-- Flatpickr CSS -->
  <link href="https://cdn.jsdelivr.net/npm/flatpickr@4.6.13/dist/flatpickr.min.css" rel="stylesheet">
  
  <%= content_for :head %>
</head>

<body class="rails_admin" data-controller="<%= controller_name %>" data-action="<%= action_name %>">
  <div id="loading" class="d-none">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <%= link_to rails_admin.dashboard_path, class: "navbar-brand" do %>
        <i class="fas fa-tachometer-alt me-2"></i>
        <%= @admin_app_name || "Admin" %>
      <% end %>
      
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <%= link_to "Dashboard", rails_admin.dashboard_path, class: "nav-link #{'active' if current_page?(rails_admin.dashboard_path)}" %>
          </li>
          <li class="nav-item">
            <%= link_to "Events", rails_admin.index_path(:event), class: "nav-link" %>
          </li>
          <li class="nav-item">
            <%= link_to "Performers", rails_admin.index_path(:performer), class: "nav-link" %>
          </li>
          <li class="nav-item">
            <%= link_to "Tips", rails_admin.index_path(:tip), class: "nav-link" %>
          </li>
          <li class="nav-item">
            <%= link_to "Users", rails_admin.index_path(:user), class: "nav-link" %>
          </li>
        </ul>
        
        <ul class="navbar-nav">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
              <i class="fas fa-user me-1"></i>
              <%= current_user&.name || current_user&.email || "Admin" %>
            </a>
            <ul class="dropdown-menu">
              <li><%= link_to "Main Site", main_app.root_path, class: "dropdown-item" %></li>
              <li><hr class="dropdown-divider"></li>
              <li><%= link_to "Logout", main_app.destroy_user_session_path, method: :delete, class: "dropdown-item" %></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
        <div class="position-sticky pt-3">
          <ul class="nav flex-column">
            <li class="nav-item">
              <%= link_to rails_admin.dashboard_path, class: "nav-link #{'active' if current_page?(rails_admin.dashboard_path)}" do %>
                <i class="fas fa-tachometer-alt me-2"></i>
                Dashboard
              <% end %>
            </li>
            <li class="nav-item">
              <%= link_to rails_admin.index_path(:event), class: "nav-link" do %>
                <i class="fas fa-calendar me-2"></i>
                Events
              <% end %>
            </li>
            <li class="nav-item">
              <%= link_to rails_admin.index_path(:performer), class: "nav-link" do %>
                <i class="fas fa-microphone me-2"></i>
                Performers
              <% end %>
            </li>
            <li class="nav-item">
              <%= link_to rails_admin.index_path(:tip), class: "nav-link" do %>
                <i class="fas fa-dollar-sign me-2"></i>
                Tips
              <% end %>
            </li>
            <li class="nav-item">
              <%= link_to rails_admin.index_path(:user), class: "nav-link" do %>
                <i class="fas fa-users me-2"></i>
                Users
              <% end %>
            </li>
          </ul>
        </div>
      </nav>

      <!-- Main content -->
      <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
          <h1 class="h2">
            <%= content_for?(:page_title) ? yield(:page_title) : @page_title %>
          </h1>
          
          <div class="btn-toolbar mb-2 mb-md-0">
            <%= content_for :contextual_tabs %>
          </div>
        </div>

        <!-- Flash messages -->
        <% flash.each do |type, message| %>
          <div class="alert alert-<%= type == 'notice' ? 'success' : 'danger' %> alert-dismissible fade show" role="alert">
            <%= message %>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        <% end %>

        <!-- Breadcrumbs -->
        <% if content_for?(:breadcrumbs) %>
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <%= yield :breadcrumbs %>
            </ol>
          </nav>
        <% end %>

        <!-- Main content area -->
        <div class="content">
          <%= yield %>
        </div>
      </main>
    </div>
  </div>

  <!-- JavaScript -->
  <%= javascript_importmap_tags %>
  
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  
  <!-- Bootstrap JS (without integrity) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- jQuery UI -->
  <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.min.js"></script>
  
  <!-- Flatpickr JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr@4.6.13/dist/flatpickr.min.js"></script>
  
  <%= content_for :javascript %>
</body>
</html>
